	<!DOCTYPE mapper
        	PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
       		"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

	<mapper namespace="com.platform.cocktail.cocktail_platform.dao.RecommendDAO">

	<select id="getTop3Cocktails" resultType="Cocktails">
 		select
 			c.cocktailName as cocktailName
		from
			cocktails c
				left join
					orderTemp ot 
				on
					c.cocktailName = ot.menuName
		group by
			c.cocktailName
		order by
			sum(ot.orderCount) desc
	</select>
	 
	<select id="customizedRecommendation" parameterType="Taste" resultType="Cocktails">
		select
    		c.cocktailName
		from
    		cocktails c
				inner join
    				taste t
				on
    				c.cocktailTaste = #{cocktailTaste}
				or
    				c.cocktailFlavor = #{cocktailFlavor}
    	where
    		t.memberId = #{memberId}
    	order by
    		case
        		when
        			c.cocktailTaste = #{cocktailTaste}  and c.cocktailFlavor = #{cocktailFlavor} then 1
        		when
        			c.cocktailTaste = #{cocktailTaste}  or c.cocktailFlavor = #{cocktailFlavor} then 2
       				else 3
    	end
	</select>

	<!-- 연령별 추천 칵테일 
    <select id="ageRecommend" resultType="Cocktails">
    	select 
       		c.cocktailName as cocktailName
		from
			cocktails c
				inner join 
					orderTemp ot 
				on 
					c.cocktailCode = ot.menuNum
				inner join 
					member m 
				on 
					ot.memberId = m.memberId
		<where>
    		<if test="  == #{birthday}">
    		</if>
    		<if test=" == #{birthday}">
   			</if>
   		 	<if test=" == #{birthday}">
   		 	</if>
    		<if test=" == #{birthday}">
    		</if>
  		</where>
		group by
			c.cocktailName
		order by
			sum(ot.orderCount) desc
    </select>
    -->

	<select id="weatherRecommend" resultType="Cocktails">
 		select
 			c.cocktailName as cocktailName
		from
			cocktails c
				inner join menuPreference mp on	c.cocktailCode = mp.menuNum
				left join orderTemp ot on c.cocktailCode = ot.menuNum
		where
			mp.companion = #{weather}
		group by
			c.cocktailName
		order by
			sum(ot.orderCount) desc;
	</select>

	<select id="companionRecommend" resultType="Cocktails">
 		select
 			c.cocktailName as cocktailName
		from
			cocktails c
				inner join menuPreference mp on	c.cocktailCode = mp.menuNum
				left join orderTemp ot on c.cocktailCode = ot.menuNum
		where
			mp.companion = #{companion}
		group by
			c.cocktailName
		order by
			sum(ot.orderCount) desc;
	</select>

	<select id="eventRecommend" resultType="Cocktails">
		select
 			c.cocktailName as cocktailName
		from
			cocktails c
				inner join menuPreference mp on	c.cocktailCode = mp.menuNum
				left join orderTemp ot on c.cocktailCode = ot.menuNum
		where
			mp.companion = #{event}
		group by
			c.cocktailName
		order by
			sum(ot.orderCount) desc;
	</select>
	
	<!-- <select id="recommendForMe" resultType="Cocktails">
    	
	</select> -->
	
	</mapper>