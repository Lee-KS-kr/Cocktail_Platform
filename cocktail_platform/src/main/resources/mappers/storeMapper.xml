<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.platform.cocktail.cocktail_platform.dao.StoreDAO">
	
	<select id="getStoreById" parameterType="String" resultType="StoreInfo">
		select
			*
		from
			storeInfo
		where
			memberId = #{memberId}
	</select>
	
	<update id="updateStoreinfo" parameterType="StoreInfo">
		update
			storeInfo
		set
			storeName = #{storeName}
			, savedFilename = #{savedFilename}
			, brn = #{brn}
			, storePhone = #{storePhone}
			, runningTime = #{runningTime}
			, dayOff = #{dayOff}
			, info = #{info}
			, postCode = #{postCode}
			, address1 = #{address1}
			, address2 = #{address2}
		where
			memberId = #{memberId}
	</update>
	
	<!-- 예약 리스트 출력 -->
	<select id="getReservelistByCode" parameterType="int" resultType="Reservation">
		select
			reserveCode
			, storeCode
			, reservationName
			, reservationPhone
			, reserveDate
			, reserveState
		from
			reservation
		order by
			reserveDate desc
	</select>
	
	<select id="findReservationByCode" parameterType="String" resultType="Reservation">
		select
			*
		from
			reservation
		where
			storeCode = #{storeCode}
	</select>
	
	<update id="changeReservationState" parameterType="Reservation">
		update
			reservation
		set
			reserveState = #{reserveState}
		where
			reserveCode = #{reserveCode}
	</update>
	
	<insert id="insertReservation" parameterType="Reservation">
		insert into
			reservation
				(
				reserveCode
				, storeCode
				, memberId
				, reservationName
				, reservationPhone
				, reserveDate
				, reserveHead
				, <if test="request != null">request
				, </if> 
				reserveState
				)
		values (
				to_char(sysdate, 'yyyymmdd') || #{storeCode} || reservation_seq.nextval
				, #{storeCode}
				, #{memberId}
				, #{reservationName}
				, #{reservationPhone}
				, to_char(sysdate, 'yyyymmdd')
				, #{reserveHead}
				, <if test="request != null">#{request}
				, </if> 
				#{reserveState}
				)
	</insert>
	
	<select id="findOrderByKey" parameterType="int" resultType="OrderTemp">
		select
			*
		from
			orderTemp
		where
			tempOrderkey = #{tempOrderkey}
	</select>
	
	<delete id="deleteOrder" parameterType="int">
		delete from
			orderTemp
		where
			tempOrderkey = #{tempOrderkey}
	</delete>
	
	<select id="getMenulistByCode" parameterType="int" resultType="Menu">
		select
			*
		from
			menu
		where
			storeCode = #{storeCode}
	</select>
	
	<select id="getMenuInfoByNum" parameterType="int" resultType="Menu">
		select
			*
		from
			menu
		where
			menuNum = #{menuNum}
		order by
			menuNum desc
	</select>
	
	<select id="getAllStorelist" resultType="StoreInfo">
		select
			*
		from
			storeInfo
		order by
			storeCode desc
	</select>
	
	<select id="getStoreinfoByCode" parameterType="int" resultType="StoreInfo">
		select
			*
		from
			storeInfo
		where
			storeCode = #{storeCode}
		order by
			storeCode desc
	</select>
	
	<select id="findReviewByCodeAndId" parameterType="HashMap" resultType="StoreReview">
		select
			*
		from
			storeReview 
		where
			storeCode = #{storeCode} and memberId = #{memberId}
		order by
			storeReviewNum desc
	</select>
	
	<select id="getReviewlistByCode" parameterType="int" resultType="StoreReview">
		select
			*
		from
			storeReview
		where
			storeCode = #{storeCode}
		order by
			storeReviewNum desc
	</select>
	
	<insert id="insertStoreReview" parameterType="StoreReview">
		insert into
			storeReview
				(storeReviewNum
				, storeCode
				, memberId
				, storeReviewScore
				, storeReviewText
				, reviewDate
				, savedFilename)
		values
				(storeReviewNum_seq.nextval
				, #{storeCode}
				, #{memberId}
				, #{storeReviewScore}
				, #{storeReviewText}
				, to_char(sysdate, 'yyyymmdd')
				, #{savedFilename})
	</insert>
	
	<insert id="insertMenuPreference" parameterType="MenuPreference">
	
	</insert>
	
	<select id="getCapacityByCode" parameterType="int" resultType="int">
	
	</select>
	
	<select id="getReservedCountByDatetime" parameterType="String" resultType="int">
	
	</select>
	
	<select id="getScheduleByCode" parameterType="int" resultType="Schedule">
	
	</select>
	
	<select id="getReservelistById" parameterType="String" resultType="Reservation">
	
	</select>
	
</mapper>
