<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.platform.cocktail.cocktail_platform.dao.StoreDAO">
	
	<select id="getStoreById" parameterType="String" resultType="StoreInfo">
		select
			*
		from
			storeInfo
		where
			memberId = #{memberId}
	</select>
	
	<update id="updateStoreinfo" parameterType="StoreInfo">
		update
			storeInfo
		set
			storeName = #{storeName}
			, savedFilename = #{savedFilename}
			, brn = #{brn}
			, storePhone = #{storePhone}
			, runningTime = #{runningTime}
			, dayOff = #{dayOff}
			, info = #{info}
			, postCode = #{postCode}
			, address1 = #{address1}
			, address2 = #{address2}
		where
			memberId = #{memberId}
	</update>
	
	<!-- 예약 리스트 출력 -->
	<select id="getReservelistByCode" parameterType="int" resultType="Reservation">
		select
			reserveCode
			, storeCode
			, reservationName
			, reservationPhone
			, reserveDate
			, reserveState
		from
			reservation
		order by
			reserveDate desc
	</select>
	
	<select id="findReservationByCode" parameterType="String" resultType="Reservation">
		select
			*
		from
			reservation
		where
			storeCode = #{storeCode}
	</select>
	
	<update id="changeReservationState" parameterType="Reservation">
		update
			reservation
		set
			reserveState = #{reserveState}
		where
			reserveCode = #{reserveCode}
	</update>
	
	<insert id="insertReservation" parameterType="Reservation">
		insert into
			reservation
				(
				reserveCode
				, storeCode
				, memberId
				, reservationName
				, reservationPhone
				, reserveDate
				, reserveHead
				, <if test="request != null">request
				, </if> 
				reserveState
				)
		values (
				to_char(sysdate, 'yyyymmdd') || #{storeCode} || reservation_seq.nextval
				, #{storeCode}
				, #{memberId}
				, #{reservationName}
				, #{reservationPhone}
				, to_char(sysdate, 'yyyymmdd')
				, #{reserveHead}
				, <if test="request != null">#{request}
				, </if> 
				#{reserveState}
				)
	</insert>
	
	<!-- 메뉴 리스트 출력 -->
	<select id="getMenulistByCode" parameterType="int" resultType="Menu">
		select
			menuNum
			, storeCode
			, category
			, price
			, canOrder
		from
			menu
		order by
			menuNum desc
	</select>
	
	<!-- 매출 관리 주문 리스트 출력 -->
	<select id="getOrderListsByCode" parameterType="int" resultType="Order">
		select
			orderCode
			, storeCode
			, orderDate
			, memberId
			, totalPrice
			, menuList
			, orderState
		from
			order
		order by
			orderCode desc
	</select>
	
</mapper>
